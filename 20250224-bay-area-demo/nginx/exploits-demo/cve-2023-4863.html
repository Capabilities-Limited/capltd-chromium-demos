<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- DO NOT EDIT: file automatically generated by ucampas from
     /auto/homes/rnw24/cheri-website/cam/cheri/index-b.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta content="text/html; charset=UTF-8" http-equiv="Content-Type" /><meta content="text/css" http-equiv="Content-Style-Type" /><title>Department of Computer Science and Technology: Chromium Vulnerabilities</title><link rel="stylesheet" type="text/css" media="all" href="style/layout.css" /><link rel="stylesheet" type="text/css" media="print" href="style/print.css" /><link href="style/blue.css" media="all" rel="stylesheet" type="text/css" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style type="text/css">
</style><link href="cheri-publications.html" rel="Next" /><link href="https://www.cl.cam.ac.uk/research/security/ctsrd/" rel="Up" /></head><body class="two-col dept">
<div id="skip"> <a href="index.html#skip-content" accesskey="2">Skip to content</a>&#160;|&#160;<a href="https://www.cam.ac.uk/site/accesskeys.html" accesskey="0">Access key help</a> </div><div id="header">
  <div id="branding"><a href="https://www.cam.ac.uk/" accesskey="1"><img src="images/identifier.svg" alt="University of Cambridge" class="ucam" /></a>
  </div>

    <div id="site-search">

    <form action="https://www.google.co.uk/search" method="get">
      <fieldset>
      <label for="search-term">Search</label>
      <input name="q" type="text" id="search-term" accesskey="4" value="" />
      <input id="search-button" src="images/button-search.gif" value="Search" alt="Search" title="Search" type="image" />
      <input name="domains" type="hidden" value="cam.ac.uk;www.cl.cam.ac.uk" /><input name="sitesearch" type="hidden" value="www.cl.cam.ac.uk" /></fieldset>
    </form>

    <ul><li class="last"><a href="https://www.cl.cam.ac.uk/search/">Advanced search</a></li><li><a href="https://www.cl.cam.ac.uk/az/">A&#8211;Z</a></li><li><a href="https://www.cl.cam.ac.uk/contact/">Contact us</a></li></ul></div>
</div>

<div id="dept-title">
<h1><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/">Department of Computer Science and Technology</a></h1></div>

<div id="container"> <a name="skip-content" id="skip-content"></a>
<ul id="nav-breadcrumb"></ul><ul id="nav-primary"><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/">CTSRD&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/news.html">Project news</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/beri/">Bluespec Extensible RISC Implementation (BERI)&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/capsicum/">Capsicum&#160;&#8594;</a></div></li><li class="active"><div><a href="index.html">Capability Hardware Enhanced RISC Instructions (CHERI)&#160;&#187;</a></div><ul><li><div><a href="cheri-publications.html">CHERI Publications</a></div></li><li><div><a href="cheri-software.html">CHERI Software Stack</a></div></li><li><div><a href="cheri-formal.html">CHERI Rigorous Engineering</a></div></li><li><div><a href="cheri-llvm.html">CHERI Clang/LLVM and LLD</a></div></li><li><div><a href="cheribsd.html">CheriBSD</a></div></li><li><div><a href="cheri-sel4.html">CHERI-seL4</a></div></li><li><div><a href="cheri-compartmentalization.html">CHERI Software Compartmentalization</a></div></li><li><div><a href="cheri-qemu.html">CHERI-QEMU</a></div></li><li><div><a href="cheri-webkit.html">CHERI-WebKit</a></div></li><li><div><a href="cheri-concentrate/index.html">CHERI Concentrate</a></div></li><li><div><a href="cheri-risc-v.html">CHERI-RISC-V</a></div></li><li><div><a href="cheri-lists.html">CHERI Mailing Lists</a></div></li><li><div><a href="cheri-slack.html">CHERI-CPU Slack</a></div></li><li><div><a href="cheri-projectideas.html">Cambridge student project ideas</a></div></li><li><div><a href="dsbd.html">The Digital Security by Design (DSbD) Initiative</a></div></li><li><div><a href="cheri-morello.html">The Arm Morello Board</a></div></li><li><div><a href="cheri-morello-software.html">CHERI Software for the Arm Morello Board</a></div></li><li><div><a href="cheri-morello-return.html">Arm Morello return programme</a></div></li><li><div><a href="workshops/index.html">CHERI Workshops&#160;&#187;</a></div></li></ul></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/soaap/">Security-Oriented Analysis of Application Programs (SOAAP)&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/tesla/">Temporally Enhanced Security Logic Assertions (TESLA)&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/smten.html">Enhancing the Satisfiability Modulo Theories Experience (Smten)</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/publications.html">Publications</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/data/">Open Data&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/posters-slides.html">Posters and slides</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/people.html">Project members</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/related.html">Related</a></div></li></ul><div id="content"><div id="content-primary">

<h1>CVE-2023-4863</h1>
 
<div>
    <h2>NIST Summary</h2>
    <p>"Heap buffer overflow in libwebp in Google Chrome prior to 116.0.5845.187 and libwebp 1.3.2 allowed a remote attacker to perform an out of bounds memory write via a crafted HTML page. (Chromium security severity: Critical)"</p>
    <h2>History</h2>
    <p>The vulnerability in our demonstration was initially reported as <b>CVE-2023-41064</b> by Apple's Security Engineering and Architecture (SEAR) team:</p> 
    <p>"A buffer overflow issue was addressed with improved memory handling. This issue is fixed in iOS 16.6.1 and iPadOS 16.6.1, macOS Monterey 12.6.9, macOS Ventura 13.5.2, iOS 15.7.9 and iPadOS 15.7.9, macOS Big Sur 11.7.10. Processing a maliciously crafted image may lead to arbitrary code execution. Apple is aware of a report that this issue may have been actively exploited."</p>
    <p>The discovery of active exploitation of the vulnerability in the wild was made by Citizen Lab during a inspection of a individual employed by a Washington DC-based civil society organisation. The exploit chain - referred to as BLASTPASS - was capable of compromising iPhones (running iOS 16.6) <i>without any interaction from the victim</i> through delivery of a malicious image over iMessage. The exploit chain was used to deliver the NSO group's Pegaus spyware onto the target's device.</p>
    <p>Initially the vulnerability was described as impacting ImageIO; with this framing of vulnerability perhaps limiting awareness of the broader scope of applicability. However, several months latter the issue resurfaced, tracked under CVE-2023-4863, now described as a heap buffer overflow in WebP within Google Chrome (again perhaps somewhat obscuring its impact on broad classes of software embedding libwebp including Rust libraries).</p>
    <h2>Demonstration</h2>
    <p>The baseline FreeBSD arm64 Chromium port replaces Chromium's dependency version of <i>libwep</i> with an updated version of the library from FreeBSD ports system that does not contain this vulnerability. For the purpose of this demonstration we have reverted to the original dependency version of libwebp shipped with Chromium 115.0.5790.100.</p> 
    <h2>Proof Of Concept (PoC)</h2>
    <p>The PoC consists of a maliciously constructed WebP image. Loading the current pages loads the PoC <a href="https://github.com/mistymntncop/CVE-2023-4863">malicious WebP image</a>, which on the baseline FreeBSD arm64 Chromium port results in a <b>silent memory corruption results</b>. At which point a fully developed exploit would be able to achieve remote code execution.</p>
    <h2>CheriABI Chromium Prototype</h2>
    <p>In the next part of the demostration we will reload the malicious WebP image using the prototype pure capability Chromium web browser.</p>
    <p><b>Note that when porting Chromium to CHERI C/C++ we undertook no actions to identify specific vulnerabilities to mitigate, nor did we make any changes specific to this particular vulnerability.</b></p>
    <img src="nso.webp" alt="PoC CVE-2023-4863"/>
</div>


</div></div><ul id="site-info"><li class="copy">&#169; 2010-2019 Robert N. M. Watson<br />Information provided by <a href="https://www.cl.cam.ac.uk/~rnw24/">Robert Watson</a></li></ul></div>
</body></html>
