<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- DO NOT EDIT: file automatically generated by ucampas from
     /auto/homes/rnw24/cheri-website/cam/cheri/index-b.html -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta content="text/html; charset=UTF-8" http-equiv="Content-Type" /><meta content="text/css" http-equiv="Content-Style-Type" /><title>Department of Computer Science and Technology: Chromium Vulnerabilities</title><link rel="stylesheet" type="text/css" media="all" href="style/layout.css" /><link rel="stylesheet" type="text/css" media="print" href="style/print.css" /><link href="style/blue.css" media="all" rel="stylesheet" type="text/css" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style type="text/css">
</style><link href="cheri-publications.html" rel="Next" /><link href="https://www.cl.cam.ac.uk/research/security/ctsrd/" rel="Up" /></head><body class="two-col dept">
<div id="skip"> <a href="index.html#skip-content" accesskey="2">Skip to content</a>&#160;|&#160;<a href="https://www.cam.ac.uk/site/accesskeys.html" accesskey="0">Access key help</a> </div><div id="header">
  <div id="branding"><a href="https://www.cam.ac.uk/" accesskey="1"><img src="images/identifier.svg" alt="University of Cambridge" class="ucam" /></a>
  </div>

    <div id="site-search">

    <form action="https://www.google.co.uk/search" method="get">
      <fieldset>
      <label for="search-term">Search</label>
      <input name="q" type="text" id="search-term" accesskey="4" value="" />
      <input id="search-button" src="images/button-search.gif" value="Search" alt="Search" title="Search" type="image" />
      <input name="domains" type="hidden" value="cam.ac.uk;www.cl.cam.ac.uk" /><input name="sitesearch" type="hidden" value="www.cl.cam.ac.uk" /></fieldset>
    </form>

    <ul><li class="last"><a href="https://www.cl.cam.ac.uk/search/">Advanced search</a></li><li><a href="https://www.cl.cam.ac.uk/az/">A&#8211;Z</a></li><li><a href="https://www.cl.cam.ac.uk/contact/">Contact us</a></li></ul></div>
</div>

<div id="dept-title">
<h1><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/">Department of Computer Science and Technology</a></h1></div>

<div id="container"> <a name="skip-content" id="skip-content"></a>
<ul id="nav-breadcrumb"></ul><ul id="nav-primary"><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/">CTSRD&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/news.html">Project news</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/beri/">Bluespec Extensible RISC Implementation (BERI)&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/capsicum/">Capsicum&#160;&#8594;</a></div></li><li class="active"><div><a href="index.html">Capability Hardware Enhanced RISC Instructions (CHERI)&#160;&#187;</a></div><ul><li><div><a href="cheri-publications.html">CHERI Publications</a></div></li><li><div><a href="cheri-software.html">CHERI Software Stack</a></div></li><li><div><a href="cheri-formal.html">CHERI Rigorous Engineering</a></div></li><li><div><a href="cheri-llvm.html">CHERI Clang/LLVM and LLD</a></div></li><li><div><a href="cheribsd.html">CheriBSD</a></div></li><li><div><a href="cheri-sel4.html">CHERI-seL4</a></div></li><li><div><a href="cheri-compartmentalization.html">CHERI Software Compartmentalization</a></div></li><li><div><a href="cheri-qemu.html">CHERI-QEMU</a></div></li><li><div><a href="cheri-webkit.html">CHERI-WebKit</a></div></li><li><div><a href="cheri-concentrate/index.html">CHERI Concentrate</a></div></li><li><div><a href="cheri-risc-v.html">CHERI-RISC-V</a></div></li><li><div><a href="cheri-lists.html">CHERI Mailing Lists</a></div></li><li><div><a href="cheri-slack.html">CHERI-CPU Slack</a></div></li><li><div><a href="cheri-projectideas.html">Cambridge student project ideas</a></div></li><li><div><a href="dsbd.html">The Digital Security by Design (DSbD) Initiative</a></div></li><li><div><a href="cheri-morello.html">The Arm Morello Board</a></div></li><li><div><a href="cheri-morello-software.html">CHERI Software for the Arm Morello Board</a></div></li><li><div><a href="cheri-morello-return.html">Arm Morello return programme</a></div></li><li><div><a href="workshops/index.html">CHERI Workshops&#160;&#187;</a></div></li></ul></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/soaap/">Security-Oriented Analysis of Application Programs (SOAAP)&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/tesla/">Temporally Enhanced Security Logic Assertions (TESLA)&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/smten.html">Enhancing the Satisfiability Modulo Theories Experience (Smten)</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/publications.html">Publications</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/data/">Open Data&#160;&#187;</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/posters-slides.html">Posters and slides</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/people.html">Project members</a></div></li><li><div><a href="https://www.cl.cam.ac.uk/research/security/ctsrd/related.html">Related</a></div></li></ul><div id="content"><div id="content-primary">

<script>
    function excercisePoC() {
        function decodeImage(imageByteStream) {
            let imageDecoder = new ImageDecoder({data: imageByteStream, type: "image/bmp"});
            imageDecoder.decode();
        }
        fetch("/exploits/bad.bmp").then(response => decodeImage(response.body))
        document.getElementById("btn1283").style.display = "none"
    }
</script>

<h1>CVE-2024-1283</h1>
 
<div>
    <h2>NIST Summary</h2>
    <p>"Heap buffer overflow in Skia in Google Chrome prior to 121.0.6167.160 allowed a remote attacker to potentially exploit heap corruption via a crafted HTML page. (Chromium security severity: High)"</p>
    <h3>Weakness Enumeration</h3>
    <table>
        <tr>
                <th>CWE-ID</th>
                <th>CWE Name</th>
                <th>Source</th>
        </tr>
        <tr>
                <td>CWE-787</td>
                <td>Out-of-bounds Write</td>
                <td>NIST</td>
        </tr>
    </table>
    <h2>Analysis</h2>
    <p>Decoding a maliciously constructed BMP image, with <code>coord_.y() == -1</code>, the function `BMPImageReader::ColorCorrectCurrentRow` calculates the address of the row buffer as:</p>
    <pre>
    <code>
        const uint32_t* addr32(int x, int y) const {
            SkASSERT((unsigned)x < (unsigned)fInfo.width()); 
            SkASSERT((unsigned)y < (unsigned)fInfo.height());
            return (const uint32_t*)((const char*)this->addr32() + (size_t)y * fRowBytes + (x << 2));
        }
    </code>
    </pre>
    <p>With <code>y == -1</code>, multipling by <code>fRowBytes</code> gives a negative number that when summed with <code>this->addr32()</code> produces a pointer that addresses the previous memory chunk. With some effort the heap can be manipulated to allocate a vulnerable memory chunk before the victim chunk. In full PoC an out-of-bounds write is used to overwrite the <code>ref_count_</code> field of a <code>CSSVariableData</code> instance creating a UAF vulnerabilityi, which in turn be exploited to gain remote code execution. See <a href="https://issues.chromium.org/issues/41494860">https://issues.chromium.org/issues/41494860</a> for further details.</p>
    <h2>Demonstration</h2>
    <p><b>Note that when porting Chromium to CHERI C/C++ we undertook no actions to identify specific vulnerabilities to mitigate, nor did we make any changes specific to this particular vulnerability.</b></p>
    <h3>Proof Of Concept (PoC)</h3>
    <p>The PoC consists of a maliciously constructed BMP image. Exercising the exploit loads the PoC <a href="https://issues.chromium.org/issues/41494860">malicious BMP image</a>, which on the baseline FreeBSD arm64 Chromium port results in a <b>silent memory corruption results</b>. With our pure-capability (CheriABI) Chromium Prototype decoding the malicious BMP image results in a CHERI out-of-bounds protection fault.</p>
    <p>No changes made to pure-capability Chromium prototype for the PoC.</p>
    <button type="button" onclick="excercisePoC()" id="btn1283">Load malicious BMP image</button>
    <img id="img1283" src=""/>
</div>


</div></div><ul id="site-info"><li class="copy">&#169; 2010-2019 Robert N. M. Watson<br />Information provided by <a href="https://www.cl.cam.ac.uk/~rnw24/">Robert Watson</a></li></ul></div>
</body></html>
